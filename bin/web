#!/usr/bin/env node
/**
 * Created by Kyriakos Barbounakis<k.barbounakis@gmail.com> on 20/11/2014.
 */
var program = require('commander'), version = "0.2.0";
program.version(version)
    .option('-o, --operation [value]', 'The operation to execute.')
    .usage('-o generate[import]');
program.parse(process.argv);

if (program.operation) {
    //load operation from lib
    var op = require('./../lib/'+ program.operation);
    if (typeof op.invoke !=='function') {
        console.error('The operation cannot be completed due to invalid signature.\n');
        return;
    }
    op.invoke(program.args, function(err, result) {
        if (err) {
            console.error('The operation cannot be completed due to internal error.\n');
            console.error(err.message);
            if (err.stack) {
                console.error(err.stack);
            }
        }
        else {
            console.log('The operation was completed succesfully.');
        }
    });
}
else if (process.argv[0]=="--version" || process.argv[0]=="-v") {
    console.log(version);
}